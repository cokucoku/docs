(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{290:function(t,i,s){},377:function(t,i,s){"use strict";s(290)},484:function(t,i,s){"use strict";s.r(i);var h={name:"LeeLuckDraw",inheritAttrs:!1,data(){return{ctx:null,haveClick:!1,deg:0,num:6,speed:0,per:Math.PI/180,perGe:2*Math.PI/this.prizes.length,saveDeg:0,pid:0,position:0}},mounted(){let t=this.$refs.luckDraw;this.ctx=t.getContext("2d"),this.id=setInterval(this.pan,1),t.addEventListener("click",t=>{let i=t.offsetX,s=t.offsetY;this.ctx.isPointInPath(i,s)&&!this.haveClick&&(this.$emit("start"),this.haveClick=!0)})},methods:{pan(){this.ctx.clearRect(0,0,this.config.width,this.config.height),this.panBg(),this.roll(),this.btn()},panDong(){this.ctx.clearRect(0,0,this.config.width,this.config.height),this.config.rotate?(this.panBg(this.position),this.roll(),console.log("转BG")):(this.panBg(),this.roll(this.position),console.log("转里面")),this.btn()},panBg(t){if(this.ctx.save(),this.config.backgroundImage){let t=new Image;t.src=this.config.backgroundImage;let i=this.config.width/t.width;this.ctx.drawImage(t,0,0,t.width*i,t.height*i)}else this.ctx.fillStyle=this.config.backgroundColor,this.ctx.beginPath(),this.ctx.arc(this.config.width/2,this.config.height/2,this.config.width/2,0,2*Math.PI),this.ctx.closePath(),this.ctx.fill();this.ctx.restore()},roll(t){if(this.ctx.save(),this.ctx.translate(this.config.width/2,this.config.height/2),this.ctx.rotate(this.deg-Math.PI/2+this.perGe/2),this.ctx.save(),this.ctx.translate(-this.config.width/2,-this.config.height/2),this.ge(),this.prize(),this.ctx.restore(),this.ctx.restore(),void 0===t)this.deg=0;else{let i=2*this.num*Math.PI+(t-1)*this.perGe;this.deg>=i/2+this.saveDeg/2?(this.speed-=.01,this.speed<=.04&&(this.speed=.03)):this.speed+=.01,this.speed=Number(this.speed.toFixed(2)),this.deg+=this.per*this.speed,console.log(this.deg,i),this.deg>=i&&(this.haveClick=!1,clearInterval(this.pid),this.deg=(t-1)*this.perGe,this.saveDeg=this.deg,this.speed=0,setTimeout(()=>{this.$emit("end",this.position-1),this.haveClick=!1},100))}},ge(){this.ctx.save();for(let t=0;t<this.prizes.length;t++)this.prizes[t].fonts&&(this.ctx.beginPath(),this.ctx.fillStyle=this.prizes[t].background,this.ctx.moveTo(this.config.width/2,this.config.height/2),this.ctx.arc(this.config.width/2,this.config.height/2,this.config.width/2-this.config.padding,-this.perGe*t,-this.perGe*(t+1),!0),this.ctx.closePath(),this.ctx.fill());this.ctx.restore()},prize(){this.ctx.save(),this.ctx.translate(this.config.width/2,this.config.height/2),this.ctx.rotate(this.perGe/2);for(let t=0;t<this.prizes.length;t++)if(this.prizes[t].fonts){this.ctx.font=this.config.fontSize+" Microsoft YaHei",this.ctx.fillStyle=this.config.fontColor,this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.ctx.rotate(-this.perGe),this.ctx.save();let i=this.prizes[t].fonts.top.split("%")[0];this.ctx.translate((this.config.width/2-this.config.padding)*i*.01,0),this.ctx.rotate(Math.PI/2),this.ctx.fillText(this.prizes[t].fonts.text,0,0),this.ctx.restore(),this.ctx.save();let s=new Image;s.src=this.prizes[t].imgs.src;let h=this.prizes[t].imgs.top.split("%")[0],e=this.prizes[t].imgs.width.split("%")[0];this.ctx.translate((this.config.width/2-this.config.padding)*h*.01,0),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(s,0,0,s.width,s.height,-s.width/2*e*.01,0,s.width*e*.01,s.height*e*.01),this.ctx.restore()}this.ctx.restore()},btn(){if(this.ctx.save(),this.ctx.fillStyle=this.btnConfig.background,this.ctx.beginPath(),this.ctx.arc(this.config.width/2,this.config.height/2,this.btnConfig.width/2,0,2*Math.PI),this.ctx.fill(),this.ctx.closePath(),this.ctx.restore(),this.btnConfig.imgs){this.ctx.save();for(let t=0;t<this.btnConfig.imgs.length;t++){let i=this.btnConfig.imgs[t].top.split("%")[0],s=this.btnConfig.imgs[t].width.split("%")[0];i*=.01,s*=.01;let h=new Image;h.src=this.btnConfig.imgs[t].src,this.ctx.drawImage(h,0,0,h.width,h.height,this.config.width/2-h.width*s/2,this.config.height/2-h.height*i/2,h.width*s,h.height*s)}this.ctx.restore()}else this.ctx.save(),this.ctx.fillStyle=this.btnConfig.background,this.ctx.beginPath(),this.ctx.moveTo(this.config.width/2+this.btnConfig.width/2-this.btnConfig.width/8,this.config.width/2),this.ctx.lineTo(this.config.width/2-this.btnConfig.width/2+this.btnConfig.width/8,this.config.width/2),this.ctx.lineTo(this.config.width/2,this.config.width/2-1.8*this.btnConfig.width/2),this.ctx.closePath(),this.ctx.fill(),this.ctx.restore();if(this.btnConfig.fonts)for(let t=0;t<this.btnConfig.fonts.length;t++){this.ctx.save(),this.ctx.font=this.btnConfig.fonts[t].fontSize+" Microsoft YaHei",this.ctx.fillStyle=this.btnConfig.fonts[t].fontColor,this.ctx.textBaseline="bottom",this.ctx.textAlign="center";let i=this.btnConfig.fonts[t].top.split("%")[0];i*=.01;let s=Number(this.btnConfig.fonts[t].fontSize.split("px")[0]);this.ctx.fillText(this.btnConfig.fonts[t].text,this.config.width/2,this.config.width/2+this.btnConfig.width/2-this.btnConfig.width*i+s/2),this.ctx.restore()}},play(t){this.position=t,this.pid=setInterval(this.panDong,1),clearInterval(this.id)}},props:{btnConfig:{type:Object,default:()=>({})},config:{type:Object,default:()=>({})},prizes:{type:Array,default:()=>[]}}},e=(s(377),s(10)),n=Object(e.a)(h,(function(){var t=this._self._c;return t("div",{staticClass:"lee-luck-draw"},[t("canvas",{ref:"luckDraw",attrs:{width:this.config.width,height:this.config.height}})])}),[],!1,null,"78cc02f4",null);i.default=n.exports}}]);